{"version":3,"file":"commonHelpers.js","sources":["../src/img/icons/bi_x-octagon.svg","../src/main.js"],"sourcesContent":["export default \"__VITE_ASSET__3108d0c6__\"","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport axios from 'axios';\n\nimport icon from './img/icons/bi_x-octagon.svg';\n\nconst form = document.querySelector('form');\nconst textArea = document.querySelector('textarea');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('span');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nconst objUrlParams =  {\n        key: \"41764698-0ccaaf72f9cf319226b6a04c5\",\n        q: '',\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        page: 1,\n        per_page: 40,\n    }\n\nform.addEventListener('submit', hendleSearch);\n\nfunction hendleSearch(event) {\n    event.preventDefault();\n    loader.classList.add(\"loader\");\n    loadMoreBtn.style.display = 'none';\n    gallery.innerHTML = '';\n    objUrlParams.page = 1;\n\n    objUrlParams.q = textArea.value.trim();\n    if (!objUrlParams.q) {\n        return;\n    }\n    fetchImages();\n\n    form.reset();\n};\n\nasync function getData() {\n    axios.defaults.baseURL = \"https://pixabay.com\";\n    return await axios.get('/api/', {params: objUrlParams});\n}\n\nasync function fetchImages() { \n    try {\n        const response = await getData();\n        const arrayOfImg = response.data.hits;\n        \n        if (arrayOfImg.length == 0 || arrayOfImg.length == response.data.totalHits) {\n            loadMoreBtn.style.display = 'none';\n            return noImages();\n        }\n\n        createGallery(arrayOfImg);\n        \n        if (arrayOfImg.length >= objUrlParams.per_page) {\n            loadMoreBtn.style.display = 'flex';\n        }\n\n    } catch(error) {\n        catchError(error);\n    } finally {\n        loader.classList.remove(\"loader\");\n    }\n};\n\nloadMoreBtn.addEventListener('click', handleLoadMore);\n\nfunction handleLoadMore() {\n    loadMoreBtn.style.display = 'none';\n    loader.classList.add(\"loader\");\n    \n    objUrlParams.page += 1;\n    getLoadMore();\n}\n\nasync function getLoadMore() {\n    try {\n        const response = await getData();\n        const arrayOfImg = response.data.hits;\n        \n        createGallery(arrayOfImg);\n        loadMoreBtn.style.display = 'flex';\n        scroll();\n\n        const totalPages = Math.ceil(response.data.totalHits / objUrlParams.per_page);\n        if (objUrlParams.page >= totalPages) {\n            loadMoreBtn.style.display = 'none';\n            return endResults();\n        }\n    } catch(error) {\n        catchError(error);\n    } finally {\n        loader.classList.remove(\"loader\");\n    }\n}\n  \nfunction createGallery(arr) {\n    const galleryList = arr.map(\n        ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n        return `\n        <li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n                class=\"gallery-image\"\n                src=\"${webformatURL}\"\n                alt=\"${tags}\"\n            />\n            </a>\n            <ul class=\"statistics\">\n                <li class=\"statistics-item\">\n                    <h2>Likes</h2>\n                    <p>${likes}</p>\n                </li>\n                <li class=\"statistics-item\">\n                    <h2>Views</h2>\n                    <p>${views}</p>\n                </li>\n                <li class=\"statistics-item\">\n                    <h2>Comments</h2>\n                    <p>${comments}</p>\n                </li>\n                <li class=\"statistics-item\">\n                    <h2>Downloads</h2>\n                    <p>${downloads}</p>\n                </li>\n            </ul>\n        </li>\n        `\n    }).join('');\n    gallery.insertAdjacentHTML('beforeend', galleryList);\n\n    const newLightBox = new SimpleLightbox('.gallery a', {\n        captionsData: \"alt\",\n        captionDelay: 250,\n    });\n\n    newLightBox.refresh();\n}\n\nfunction scroll() {\n    const card = document.querySelector('.gallery-item');\n    const heightCard = card.getBoundingClientRect();\n    window.scrollBy(0, heightCard.height * 2);\n}\n\nfunction catchError(error) {\n    console.log(error);\n    const errName = error.name;\n    const errText = error.message;\n    errorMessage(errName, errText);\n}\n\nconst objErrorParams = {\n    position: \"topRight\",\n    backgroundColor: \"#EF4040\",\n    messageColor: '#fff',\n    iconUrl: icon,\n}\n\nfunction noImages() {\n    iziToast.error({\n      message: \"Sorry, there are no images matching<br/>your search query. Please try again!\",\n      ...objErrorParams,\n    });\n}\n\nfunction errorMessage(name, text) {\n    iziToast.error({\n      message: `${name}: ${text}. Please try again!`,\n      ...objErrorParams,\n    });\n}\n\nfunction endResults() {\n    iziToast.error({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        ...objErrorParams,\n      });\n};\n\n"],"names":["icon","form","textArea","gallery","loader","loadMoreBtn","objUrlParams","hendleSearch","event","fetchImages","getData","axios","response","arrayOfImg","noImages","createGallery","error","catchError","handleLoadMore","getLoadMore","scroll","totalPages","endResults","arr","galleryList","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","heightCard","errName","errText","errorMessage","objErrorParams","iziToast","name","text"],"mappings":"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"}