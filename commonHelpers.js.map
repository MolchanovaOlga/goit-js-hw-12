{"version":3,"file":"commonHelpers.js","sources":["../src/img/icons/bi_x-octagon.svg","../src/main.js"],"sourcesContent":["export default \"__VITE_ASSET__3108d0c6__\"","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport axios from 'axios';\n\nimport icon from './img/icons/bi_x-octagon.svg';\n\nconst form = document.querySelector('form');\nconst textArea = document.querySelector('textarea');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('span');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nlet counter = 1;\nlet perPage = 40;\n\nform.addEventListener('submit', event => {\n    event.preventDefault();\n    loader.classList.add(\"loader\");\n    gallery.innerHTML = '';\n    \n    fetchImages();\n    \n    form.reset();\n});\n\nasync function getData(val) {\n\n    axios.defaults.baseURL = \"https://pixabay.com\";\n    return await axios.get('/api/', {\n        params: {\n            key: \"41764698-0ccaaf72f9cf319226b6a04c5\",\n            q: val,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            page: counter,\n            per_page: perPage,\n        }\n    });\n}\n\nasync function fetchImages() { \n    try {\n        const valueOfTextarea = textArea.value;\n        const response = await getData(valueOfTextarea);\n        const arrayOfImg = response.data.hits;\n        const totalPages = Math.ceil(response.data.totalHits / perPage);\n        \n        if (arrayOfImg.length == 0) {\n            return noImages();\n        }\n\n        createGallery(arrayOfImg);\n        \n        if (arrayOfImg.length >= perPage) {\n            loadMoreBtn.style.display = 'flex';\n            loadMoreBtn.addEventListener('click', () => {\n                loadMoreBtn.style.display = 'none';\n                loader.classList.add(\"loader\");\n                 \n                getLoadMore(valueOfTextarea, totalPages);\n            });\n        }\n\n    } catch(error) {\n        catchError(error);\n    } finally {\n        loader.classList.remove(\"loader\");\n    }\n};\n\nasync function getLoadMore(val, num) {\n    counter += 1;\n    try {\n        const response = await getData(val);\n        const arrayOfImg = response.data.hits;\n        createGallery(arrayOfImg);\n        loadMoreBtn.style.display = 'flex';\n            \n        if (counter >= num) {\n            loadMoreBtn.style.display = 'none';\n            return endResults();\n        }\n    } catch(error) {\n        catchError(error);\n    } finally {\n        loader.classList.remove(\"loader\");\n    }\n}\n  \nfunction createGallery(arr) {\n    const galleryList = arr.map(\n        ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n        return `\n        <li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n                class=\"gallery-image\"\n                src=\"${webformatURL}\"\n                alt=\"${tags}\"\n            />\n            </a>\n            <ul class=\"statistics\">\n                <li class=\"statistics-item\">\n                    <h2>Likes</h2>\n                    <p>${likes}</p>\n                </li>\n                <li class=\"statistics-item\">\n                    <h2>Views</h2>\n                    <p>${views}</p>\n                </li>\n                <li class=\"statistics-item\">\n                    <h2>Comments</h2>\n                    <p>${comments}</p>\n                </li>\n                <li class=\"statistics-item\">\n                    <h2>Downloads</h2>\n                    <p>${downloads}</p>\n                </li>\n            </ul>\n        </li>\n        `\n    }).join('');\n    gallery.insertAdjacentHTML('beforeend', galleryList);\n\n    const newLightBox = new SimpleLightbox('.gallery a', {\n        captionsData: \"alt\",\n        captionDelay: 250,\n    });\n\n    newLightBox.refresh();\n}\n\nfunction noImages() {\n    iziToast.error({\n      message: \"Sorry, there are no images matching<br/>your search query. Please try again!\",\n      position: \"topRight\",\n      backgroundColor: \"#EF4040\",\n      messageColor: '#fff',\n      iconUrl: icon,\n    });\n}\n\nfunction catchError(error) {\n    console.log(error);\n    const errName = error.name;\n    const errText = error.message;\n    errorMessage(errName, errText);\n}\n  \n\nfunction errorMessage(name, text) {\n    iziToast.error({\n      message: `${name}: ${text}. Please try again!`,\n      position: \"topRight\",\n      backgroundColor: \"#EF4040\",\n      messageColor: '#fff',\n      iconUrl: icon,\n    });\n}\n\nfunction endResults() {\n    iziToast.error({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: \"topRight\",\n        backgroundColor: \"#EF4040\",\n        messageColor: '#fff',\n        iconUrl: icon,\n      });\n};\n\n"],"names":["icon","form","textArea","gallery","loader","loadMoreBtn","counter","perPage","event","fetchImages","getData","val","axios","valueOfTextarea","response","arrayOfImg","totalPages","noImages","createGallery","getLoadMore","error","catchError","num","endResults","arr","galleryList","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","iziToast","errName","errText","errorMessage","name","text"],"mappings":"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"}